<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Amigos Unite</title>
  <link rel="icon" type="image/svg+xml" href="/favicon.ico">

    <!-- Default (first visit, JS decides quickly; noscript fallback below) -->
  <link id="theme-loader" rel="stylesheet" href="/themes/public/loaders/blue-light.loader.css">


  <!-- Early inline loader to avoid flash (localStorage-based) -->
  <script>
    (function () {
      try {
        // Decide area by URL (tweak if you mount admin elsewhere)
        var area = location.pathname.startsWith('/admin') ? 'admin' : 'public';

        // Read stored prefs (match publicApi.ts keys)
        var raw = localStorage.getItem('theme:' + area);
        var stored = raw ? JSON.parse(raw) : null;

        // Defaults
        var prefersDark = matchMedia && matchMedia('(prefers-color-scheme: dark)').matches;
        var mode = (stored && stored.mode) || (prefersDark ? 'dark' : 'light');
        var palette = area === 'public' ? ((stored && stored.palette) || 'blue') : 'admin';

        // Compute href for the loader
        var href = area === 'admin'
          ? '/themes/admin/loaders/' + (mode === 'dark' ? 'dark' : 'light') + '-theme.loader.css'
          : '/themes/public/loaders/' + palette + '-' + mode + '.loader.css';

        // Ensure the <link id="theme-loader"> exists and points to the right file
        var link = document.getElementById('theme-loader');
        if (!link) {
          link = document.createElement('link');
          link.id = 'theme-loader';
          link.rel = 'stylesheet';
          document.head.appendChild(link);
        }
        if (link.getAttribute('href') !== href) link.setAttribute('href', href);

        // Set data-* attributes early for CSS hooks
        var root = document.documentElement;
        root.setAttribute('data-theme-area', area);
        root.setAttribute('data-theme-mode', mode);
        if (area === 'public') root.setAttribute('data-theme-palette', palette);
        else root.removeAttribute('data-theme-palette');
      } catch (e) {
        // swallow â€“ fall back to the default <link> already in the head
      }
    })();
  </script>

  <noscript>
    <!-- No JS: OKLCH/HSL is chosen inside the loader -->
    <link rel="stylesheet" href="/themes/public/loaders/blue-light.loader.css">
  </noscript>

</head>
<body>
  <div id="root"></div>
  <script type="module" src="/src/main.tsx" defer></script>
</body>
</html>
